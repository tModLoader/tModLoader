--- src/TerrariaNetCore/ReLogic/OS/Windows/NativeMethods.cs
+++ src/tModLoader/ReLogic/OS/Windows/NativeMethods.cs
@@ -1,14 +_,16 @@
 using System;
 using System.Runtime.InteropServices;
+using System.Text;
 #if !NETCORE
 using System.Windows.Forms;
 #endif
 
 namespace ReLogic.OS.Windows;
 
-internal static class NativeMethods
+internal static partial class NativeMethods
 {
 	public delegate IntPtr WndProcCallback(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam);
+	public delegate bool EnumWindowsProcCallback(IntPtr hWnd, IntPtr lParam);
 
 	public enum StdHandleType
 	{
@@ -115,22 +_,36 @@
 		public string lpszProgressTitle;
 	}
 
+	[DllImport("kernel32.dll")]
+	public static extern int GetCurrentProcessId();
+
+	[DllImport("kernel32.dll")]
+	public static extern int GetCurrentThreadId();
+
+	[DllImport("user32.dll")]
+	[return: MarshalAs(UnmanagedType.Bool)]
+	public static extern bool EnumWindows(EnumWindowsProcCallback lpEnumFunc, IntPtr lParam);
+
+	[DllImport("user32.dll")]
+	public static extern int GetWindowThreadProcessId(IntPtr hWnd, out int lpdwProcessId);
+
+	[DllImport("user32.dll")]
+	public static extern int GetWindowText(IntPtr hWnd, StringBuilder text, int count);
+
 	[DllImport("user32.dll", CharSet = CharSet.Unicode)]
 	public static extern IntPtr CallWindowProc(IntPtr lpPrevWndFunc, IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam);
 
 	[DllImport("user32.dll", CharSet = CharSet.Unicode)]
-	public static extern int SetWindowLong(IntPtr hWnd, int nIndex, int dwNewLong);
+	public static extern IntPtr SetWindowLongPtr(IntPtr hWnd, int nIndex, IntPtr dwNewLong);
 
 	[DllImport("user32.dll", CharSet = CharSet.Unicode)]
 	public static extern IntPtr DefWindowProc(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam);
 
-#if NETCORE
 	[DllImport("user32.dll")]
 	public static extern IntPtr GetDC(IntPtr hWnd);
-#else
+
 	[DllImport("user32.dll", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Unicode)]
 	public static extern bool TranslateMessage(ref Message message);
-#endif
 
 	[DllImport("user32.dll", CharSet = CharSet.Unicode)]
 	public static extern IntPtr GetForegroundWindow();
@@ -143,6 +_,9 @@
 
 	[DllImport("kernel32.dll", CharSet = CharSet.Unicode)]
 	public static extern IntPtr GetStdHandle(StdHandleType nStdHandle);
+
+	[DllImport("kernel32.dll", CharSet = CharSet.Unicode)]
+	public static extern IntPtr GetModuleHandle(string lpModuleName);
 
 	[DllImport("user32.dll")]
 	[return: MarshalAs(UnmanagedType.Bool)]
