--- src/TerrariaNetCore/ReLogic/OS/Windows/WindowsPlatform.cs
+++ src/tModLoader/ReLogic/OS/Windows/WindowsPlatform.cs
@@ -1,14 +_,14 @@
 using System;
+using System.Runtime.InteropServices;
+using System.Text;
 using ReLogic.Localization.IME;
 
 namespace ReLogic.OS.Windows;
 
 internal class WindowsPlatform : Platform
 {
-#if !NETCORE
 	private WindowsMessageHook _wndProcHook;
 	private bool _disposedValue;
-#endif
 
 	public WindowsPlatform()
 		: base(PlatformType.Windows)
@@ -21,13 +_,26 @@
 
 	public override void InitializeClientServices(IntPtr windowHandle)
 	{
-#if NETCORE
-		RegisterService((IImeService)new FnaIme());
-	}
-#else
+		// windowHandle is invalid, need to find it on our own
+		int currentProcessId = NativeMethods.GetCurrentProcessId();
+
+		NativeMethods.EnumWindows(delegate(IntPtr wnd, IntPtr param) {
+			NativeMethods.GetWindowThreadProcessId(wnd, out int processId);
+			if (processId == currentProcessId) {
+				var buffer = new StringBuilder(1024);
+				NativeMethods.GetWindowText(wnd, buffer, 1024);
+
+				if (buffer.ToString().Contains("Terraria")) {
+					windowHandle = wnd;
+					return false;
+				}
+			}
+
+			return true; // Continue enumerating windows
+		}, IntPtr.Zero);
+
 		if (_wndProcHook == null)
 			_wndProcHook = new WindowsMessageHook(windowHandle);
-
 		RegisterService((IImeService)new WindowsIme(_wndProcHook, windowHandle));
 	}
 
@@ -43,5 +_,4 @@
 			base.Dispose(disposing);
 		}
 	}
-#endif
 }
